{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WorkerPipeline = void 0;\nvar worker_1 = __importDefault(require(\"@vibrant/worker\"));\nvar color_1 = require(\"@vibrant/color\");\nvar utils_1 = require(\"../../utils\");\n/**\n * Client side (runs in UI thread)\n */\nvar WorkerPipeline = /** @class */function () {\n  function WorkerPipeline(PipelineWorker) {\n    this.PipelineWorker = PipelineWorker;\n    this._manager = new worker_1.default();\n    this._manager.register('pipeline', PipelineWorker);\n  }\n  WorkerPipeline.prototype._rehydrate = function (result) {\n    var colors = result.colors,\n      palettes = result.palettes;\n    result.colors = colors.map(function (s) {\n      return color_1.Swatch.clone(s);\n    });\n    result.palettes = utils_1.mapValues(palettes, function (p) {\n      return utils_1.mapValues(p, function (c) {\n        return c ? color_1.Swatch.clone(c) : null;\n      });\n    });\n    return result;\n  };\n  WorkerPipeline.prototype.process = function (imageData, opts) {\n    var _this = this;\n    return this._manager.invokeWorker('pipeline', [imageData, opts], [imageData.data.buffer]).then(function (result) {\n      return _this._rehydrate(result);\n    });\n  };\n  return WorkerPipeline;\n}();\nexports.WorkerPipeline = WorkerPipeline;","map":{"version":3,"names":["worker_1","__importDefault","require","color_1","utils_1","WorkerPipeline","PipelineWorker","_manager","default","register","prototype","_rehydrate","result","colors","palettes","map","s","Swatch","clone","mapValues","p","c","process","imageData","opts","_this","invokeWorker","data","buffer","then","exports"],"sources":["../../../../../../packages/vibrant-core/src/pipeline/worker/client.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;AACA,IAAAA,QAAA,GAAAC,eAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AACA,IAAAE,OAAA,GAAAF,OAAA;AAEA;;;AAGA,IAAAG,cAAA;EAEE,SAAAA,eAAuBC,cAA+B;IAA/B,KAAAA,cAAc,GAAdA,cAAc;IAD7B,KAAAC,QAAQ,GAAG,IAAIP,QAAA,CAAAQ,OAAa,EAAE;IAEpC,IAAI,CAACD,QAAQ,CAACE,QAAQ,CAAC,UAAU,EAAEH,cAAc,CAAC;EACpD;EACQD,cAAA,CAAAK,SAAA,CAAAC,UAAU,GAAlB,UAAoBC,MAAqB;IACjC,IAAAC,MAAM,GAAeD,MAAM,CAAAC,MAArB;MAAEC,QAAQ,GAAKF,MAAM,CAAAE,QAAX;IACtBF,MAAM,CAACC,MAAM,GAAGA,MAAM,CAACE,GAAG,CAAC,UAACC,CAAC;MAAK,OAAAb,OAAA,CAAAc,MAAM,CAACC,KAAK,CAACF,CAAC,CAAC;IAAf,CAAe,CAAC;IAElDJ,MAAM,CAACE,QAAQ,GAAGV,OAAA,CAAAe,SAAS,CAACL,QAAQ,EAAE,UAACM,CAAC;MAAK,OAAAhB,OAAA,CAAAe,SAAS,CAACC,CAAC,EAAE,UAACC,CAAC;QAAK,OAAAA,CAAC,GAAGlB,OAAA,CAAAc,MAAM,CAACC,KAAK,CAACG,CAAC,CAAC,GAAG,IAAI;MAA1B,CAA0B,CAAY;IAA1D,CAA0D,CAAC;IACxG,OAAOT,MAAM;EACf,CAAC;EACDP,cAAA,CAAAK,SAAA,CAAAY,OAAO,GAAP,UAASC,SAAoB,EAAEC,IAAoB;IAAnD,IAAAC,KAAA;IACE,OAAO,IAAI,CAAClB,QAAQ,CAACmB,YAAY,CAAC,UAAU,EAAE,CAACH,SAAS,EAAEC,IAAI,CAAC,EAAE,CAACD,SAAS,CAACI,IAAI,CAACC,MAAM,CAAC,CAAC,CACtFC,IAAI,CAAC,UAACjB,MAAM;MAAK,OAAAa,KAAI,CAACd,UAAU,CAACC,MAAuB,CAAC;IAAxC,CAAwC,CAAC;EAC/D,CAAC;EACH,OAAAP,cAAC;AAAD,CAAC,CAhBD;AAAayB,OAAA,CAAAzB,cAAA,GAAAA,cAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}