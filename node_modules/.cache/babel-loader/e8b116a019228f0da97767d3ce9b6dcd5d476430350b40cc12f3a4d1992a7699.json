{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar Histogram = /** @class */function () {\n  function Histogram(pixels, opts) {\n    this.pixels = pixels;\n    this.opts = opts;\n    var sigBits = opts.sigBits;\n    var getColorIndex = function (r, g, b) {\n      return (r << 2 * sigBits) + (g << sigBits) + b;\n    };\n    this.getColorIndex = getColorIndex;\n    var rshift = 8 - sigBits;\n    var hn = 1 << 3 * sigBits;\n    var hist = new Uint32Array(hn);\n    var rmax;\n    var rmin;\n    var gmax;\n    var gmin;\n    var bmax;\n    var bmin;\n    var r;\n    var g;\n    var b;\n    var a;\n    rmax = gmax = bmax = 0;\n    rmin = gmin = bmin = Number.MAX_VALUE;\n    var n = pixels.length / 4;\n    var i = 0;\n    while (i < n) {\n      var offset = i * 4;\n      i++;\n      r = pixels[offset + 0];\n      g = pixels[offset + 1];\n      b = pixels[offset + 2];\n      a = pixels[offset + 3];\n      // Ignored pixels' alpha is marked as 0 in filtering stage\n      if (a === 0) continue;\n      r = r >> rshift;\n      g = g >> rshift;\n      b = b >> rshift;\n      var index = getColorIndex(r, g, b);\n      hist[index] += 1;\n      if (r > rmax) rmax = r;\n      if (r < rmin) rmin = r;\n      if (g > gmax) gmax = g;\n      if (g < gmin) gmin = g;\n      if (b > bmax) bmax = b;\n      if (b < bmin) bmin = b;\n    }\n    this._colorCount = hist.reduce(function (total, c) {\n      return c > 0 ? total + 1 : total;\n    }, 0);\n    this.hist = hist;\n    this.rmax = rmax;\n    this.rmin = rmin;\n    this.gmax = gmax;\n    this.gmin = gmin;\n    this.bmax = bmax;\n    this.bmin = bmin;\n  }\n  Object.defineProperty(Histogram.prototype, \"colorCount\", {\n    get: function () {\n      return this._colorCount;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return Histogram;\n}();\nexports.default = Histogram;","map":{"version":3,"names":["Histogram","pixels","opts","sigBits","getColorIndex","r","g","b","rshift","hn","hist","Uint32Array","rmax","rmin","gmax","gmin","bmax","bmin","a","Number","MAX_VALUE","n","length","i","offset","index","_colorCount","reduce","total","c","Object","defineProperty","prototype","get"],"sources":["../../../../packages/vibrant-image/src/histogram.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}