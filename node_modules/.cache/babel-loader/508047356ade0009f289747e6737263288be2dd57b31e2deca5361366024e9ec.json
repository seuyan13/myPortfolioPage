{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.applyFilters = exports.ImageBase = void 0;\nvar ImageBase = /** @class */function () {\n  function ImageBase() {}\n  ImageBase.prototype.scaleDown = function (opts) {\n    var width = this.getWidth();\n    var height = this.getHeight();\n    var ratio = 1;\n    if (opts.maxDimension > 0) {\n      var maxSide = Math.max(width, height);\n      if (maxSide > opts.maxDimension) ratio = opts.maxDimension / maxSide;\n    } else {\n      ratio = 1 / opts.quality;\n    }\n    if (ratio < 1) this.resize(width * ratio, height * ratio, ratio);\n  };\n  return ImageBase;\n}();\nexports.ImageBase = ImageBase;\nfunction applyFilters(imageData, filters) {\n  if (filters.length > 0) {\n    var pixels = imageData.data;\n    var n = pixels.length / 4;\n    var offset = void 0;\n    var r = void 0;\n    var g = void 0;\n    var b = void 0;\n    var a = void 0;\n    for (var i = 0; i < n; i++) {\n      offset = i * 4;\n      r = pixels[offset + 0];\n      g = pixels[offset + 1];\n      b = pixels[offset + 2];\n      a = pixels[offset + 3];\n      // Mark ignored color\n      for (var j = 0; j < filters.length; j++) {\n        if (!filters[j](r, g, b, a)) {\n          pixels[offset + 3] = 0;\n          break;\n        }\n      }\n    }\n  }\n  return imageData;\n}\nexports.applyFilters = applyFilters;","map":{"version":3,"names":["ImageBase","prototype","scaleDown","opts","width","getWidth","height","getHeight","ratio","maxDimension","maxSide","Math","max","quality","resize","exports","applyFilters","imageData","filters","length","pixels","data","n","offset","r","g","b","a","i","j"],"sources":["../../../../packages/vibrant-image/src/index.ts"],"sourcesContent":[null],"mappings":";;;;;;AAoCA,IAAAA,SAAA;EAAA,SAAAA,UAAA,GA0BA;EAfEA,SAAA,CAAAC,SAAA,CAAAC,SAAS,GAAT,UAAWC,IAAkB;IAC3B,IAAIC,KAAK,GAAW,IAAI,CAACC,QAAQ,EAAE;IACnC,IAAIC,MAAM,GAAW,IAAI,CAACC,SAAS,EAAE;IAErC,IAAIC,KAAK,GAAW,CAAC;IAErB,IAAIL,IAAI,CAACM,YAAY,GAAG,CAAC,EAAE;MACzB,IAAIC,OAAO,GAAWC,IAAI,CAACC,GAAG,CAACR,KAAK,EAAEE,MAAM,CAAC;MAC7C,IAAII,OAAO,GAAGP,IAAI,CAACM,YAAY,EAAED,KAAK,GAAGL,IAAI,CAACM,YAAY,GAAGC,OAAO;KACrE,MAAM;MACLF,KAAK,GAAG,CAAC,GAAGL,IAAI,CAACU,OAAO;;IAG1B,IAAIL,KAAK,GAAG,CAAC,EAAE,IAAI,CAACM,MAAM,CAACV,KAAK,GAAGI,KAAK,EAAEF,MAAM,GAAGE,KAAK,EAAEA,KAAK,CAAC;EAClE,CAAC;EACH,OAAAR,SAAC;AAAD,CAAC,CA1BD;AAAsBe,OAAA,CAAAf,SAAA,GAAAA,SAAA;AA4BtB,SAAgBgB,YAAYA,CAAEC,SAAoB,EAAEC,OAAiB;EACnE,IAAIA,OAAO,CAACC,MAAM,GAAG,CAAC,EAAE;IACtB,IAAIC,MAAM,GAAGH,SAAS,CAACI,IAAI;IAC3B,IAAIC,CAAC,GAAGF,MAAM,CAACD,MAAM,GAAG,CAAC;IACzB,IAAII,MAAM;IACV,IAAIC,CAAC;IACL,IAAIC,CAAC;IACL,IAAIC,CAAC;IACL,IAAIC,CAAC;IACL,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGN,CAAC,EAAEM,CAAC,EAAE,EAAE;MAC1BL,MAAM,GAAGK,CAAC,GAAG,CAAC;MACdJ,CAAC,GAAGJ,MAAM,CAACG,MAAM,GAAG,CAAC,CAAC;MACtBE,CAAC,GAAGL,MAAM,CAACG,MAAM,GAAG,CAAC,CAAC;MACtBG,CAAC,GAAGN,MAAM,CAACG,MAAM,GAAG,CAAC,CAAC;MACtBI,CAAC,GAAGP,MAAM,CAACG,MAAM,GAAG,CAAC,CAAC;MACtB;MACA,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGX,OAAO,CAACC,MAAM,EAAEU,CAAC,EAAE,EAAE;QACvC,IAAI,CAACX,OAAO,CAACW,CAAC,CAAC,CAACL,CAAC,EAAEC,CAAC,EAAEC,CAAC,EAAEC,CAAC,CAAC,EAAE;UAC3BP,MAAM,CAACG,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC;UACtB;;;;;EAMR,OAAON,SAAS;AAClB;AA1BAF,OAAA,CAAAC,YAAA,GAAAA,YAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}